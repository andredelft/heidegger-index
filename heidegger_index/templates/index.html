{% extends '_site_base.html' %}
{% load i18n %}

{% get_available_languages as languages %}

{% block full_head_title %}{% translate "Heidegger index" %}{% endblock full_head_title %}

{% block body %}
<h1 class="py-4 text-5xl font-bold dark:text-white">{% translate "Heidegger index" %}</h1>
<p class="pb-12 {{ body_text }}">
  {% translate "Managed by" %}: <a href="https://github.com/andredelft" target="_blank" rel="noopener noreferrer" class="{{ link_decoration }}">André van Delft</a> &amp; <a href="https://github.com/johannesdewit" target="_blank" rel="noopener noreferrer" class="{{ link_decoration }}">Johannes de Wit</a>
</p>

{% include '_toc.html' %}

{% if alphabet.pre %}
  <div>
  <a href="{% url 'index:home' %}?start={{ alphabet.pre|last }}#{{ alphabet.pre|last }}" class="{{ hidden_link_decoration }}">← {% translate "Previous" %}</a>
  </div>
{% endif %}

{% regroup lemmas by first_letter as letter_list %}
{% for letter in letter_list %}
  <div id="{{ letter.grouper }}" class="mt-12 text-5xl dark:text-white scroll-mt-24">{{ letter.grouper }}</div>
  {% for lemma in letter.list %}
  <div class="my-4">
    <h3 class="leading-tight">
      <a href="{% url 'index:lemma-detail' lemma.slug %}" class="{{ hidden_link_decoration }}{% if lemma.type == "w" %} italic{% endif %}">{{ lemma }}</a>
    </h3>
    {% include '_group_by_work.html' with ref_list=lemma.pagereference_set.all inline=True %}
    {% with lemma.children.all as children %}
    {% if children %}
    <ol class="pl-4 my-2 text-xl">
      {% for child in children %}<li>
        <a class="{{ hidden_link_decoration }}" href="{% url 'index:lemma-detail' lemma.slug %}#{{ child.slug }}">
          {{ child }}
        </a>
        {% include '_group_by_work.html' with ref_list=child.pagereference_set.all inline=True %}
      </li>{% endfor %}
    </ol>
    {% endif %}
    {% endwith %}
  </div>
  {% endfor %}
{% endfor %}

{% if alphabet.post %}
  <div class="pt-8">
    <a href="{% url 'index:home' %}?start={{ alphabet.post|first }}#{{ alphabet.post|first }}" class="{{ hidden_link_decoration }}">{% translate "Next" %} →</a>
  </div>
{% endif %}

<h2 class="mt-16 mb-8 text-3xl font-bold dark:text-white scroll-mt-24" id="bibliography">{% translate "Bibliography" %}</h2>
<div class="flex flex-col gap-8">
  {% for work in works %}
  {% if work.reference %}
  <a href="{% url 'index:work-detail' work.slug %}" class="flex gap-4 text-1.5xl transition-colors hover:bg-slate-200 dark:hover:bg-slate-600 rounded-md p-2">
    <div class="w-16 font-semibold break-words sm:break-normal sm:w-28 shrink-0 dark:text-white">{{ work.key }}</div>
    <div class="leading-snug {{ body_text }}">{{ work.reference|safe }}</div>
  </a>
  {% endif %}
  {% endfor %}
</div>

{% endblock %}